<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BHU MPA SGPA Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: #e5ddd5;
      background-image: url('https://www.transparenttextures.com/patterns/speech-bubbles.png');
      background-repeat: repeat;
      background-attachment: fixed;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    header {
      background: rgba(0, 86, 179, 0.8);
      backdrop-filter: blur(6px);
      width: 100%;
      text-align: center;
      padding: 20px;
      color: white;
      font-size: 1.8rem;
      border-radius: 0 0 20px 20px;
      margin-bottom: 20px;
    }

    .container {
      background: rgba(255, 255, 255, 0.6);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 20px;
      padding: 30px;
      width: 95%;
      max-width: 500px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }

    input, select, button {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 10px;
      font-size: 1rem;
    }

    button {
      background-color: #0056b3;
      color: white;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: #003f80;
    }

    .subject-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .subject-row input {
      flex: 1;
    }

    .results {
      margin-top: 20px;
      border-collapse: collapse;
      width: 100%;
    }

    .results th, .results td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }

    .results th {
      background-color: #f2f2f2;
    }

    footer {
      margin-top: 30px;
      text-align: center;
      color: white;
      background: black;
      width: 100%;
      padding: 10px;
      border-radius: 20px;
    }

    .footer-link {
      color: green;
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>üéì BHU MPA SGPA CALCULATOR</header>
  <div class="container">
    <label>üÜî Roll Number</label>
    <input type="number" id="roll" inputmode="numeric">

    <label>üéì Semester</label>
    <select id="semester" onchange="loadSubjects()">
      <option value="">--Select Semester--</option>
      <option value="1">Semester 1</option>
      <option value="2">Semester 2</option>
    </select>

    <div id="subjects"></div>

    <button id="calculate" onclick="calculateSGPA()" disabled>üìä Calculate SGPA</button>

    <div id="output"></div>
  </div>

  <footer>
    Made by Utkarsh with ‚ù§Ô∏è<br>
    <a class="footer-link" href="https://t.me/ReallyUtkarsh" target="_blank">Contact - @ReallyUtkarsh</a>
  </footer>

  <script>
    const subjectsBySemester = {
      1: ["PA", "ADT - CE", "PPA", "EIFA", "C&A"],
      2: ["PA", "ADT - ME", "PPA", "IAD", "C&A"]
    };

    function loadSubjects() {
      const semester = document.getElementById('semester').value;
      const subjectDiv = document.getElementById('subjects');
      subjectDiv.innerHTML = '';

      if (!semester) return;

      subjectsBySemester[semester].forEach(sub => {
        const row = document.createElement('div');
        row.className = 'subject-row';
        row.innerHTML = `
          <label style="width: 30%;">${sub}</label>
          <input type="number" placeholder="Sessional (30)" max="30" min="0" inputmode="numeric" class="sessional">
          <input type="number" placeholder="Theory (70)" max="70" min="0" inputmode="numeric" class="theory">
        `;
        subjectDiv.appendChild(row);
      });

      document.getElementById('calculate').disabled = false;
    }

    function getGradePoint(total) {
      if (total >= 91) return 10;
      if (total >= 81) return 9;
      if (total >= 71) return 8;
      if (total >= 61) return 7;
      if (total >= 51) return 6;
      if (total >= 41) return 5;
      if (total >= 31) return 4;
      return 0;
    }

    function calculateSGPA() {
      const roll = document.getElementById('roll').value;
      if (!roll) return alert("Please enter Roll Number");

      const sessionals = document.querySelectorAll('.sessional');
      const theory = document.querySelectorAll('.theory');
      const semester = document.getElementById('semester').value;
      const subjects = subjectsBySemester[semester];

      let totalCredits = subjects.length * 3;
      let totalCreditPoints = 0;

      let table = `<table class='results'><tr><th>Subject</th><th>Sessional</th><th>Theory</th><th>Total</th><th>Grade</th></tr>`;

      for (let i = 0; i < subjects.length; i++) {
        const s = parseInt(sessionals[i].value || 0);
        const t = parseInt(theory[i].value || 0);

        if (s > 30 || t > 70) {
          alert("Marks exceed limit in " + subjects[i]);
          return;
        }

        const total = s + t;
        const grade = getGradePoint(total);
        totalCreditPoints += grade * 3;

        table += `<tr><td>${subjects[i]}</td><td>${s}</td><td>${t}</td><td>${total}</td><td>${grade}</td></tr>`;
      }

      const sgpa = (totalCreditPoints / totalCredits).toFixed(2);
      table += `</table><h3 style='text-align:center;'>üéØ SGPA: ${sgpa}</h3>`;

      document.getElementById('output').innerHTML = table;

      fetch("https://script.google.com/macros/s/AKfycbzgxYSIBOm1vgevj676JQngyGCMNhsxHJLIXz7L82RfmrjWIlEEyfGdASUXDBRd6Y8n/exec", {
        method: "POST",
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          rollNumber: roll,
          sgpa: sgpa
        })
      }).then(res => res.text())
        .then(data => console.log("Saved:", data))
        .catch(err => console.error("Error:", err));
    }
  </script>
</body>
</html>
